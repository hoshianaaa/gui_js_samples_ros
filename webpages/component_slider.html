<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>

<script type="text/javascript" src="http://static.robotwebtools.org/EventEmitter2/current/eventemitter2.min.js"></script>
<script type="text/javascript" src="http://static.robotwebtools.org/roslibjs/current/roslib.min.js"></script>

  <script>


    var topic_name = "data"
    var ros = null;
    var pub = null;

// --------- get window parameter ---------

    window.onload = function() {
        // URLを取得
        const url = new URL(window.location.href);

        // URLSearchParamsオブジェクトを取得
        const params = url.searchParams;

        // consoleに受け取ったパラメータを出力
        console.log(params);

        // パラメータから「username」を取得
        topic_name = params.get("topic_name");

        console.log(topic_name);


        ros = new ROSLIB.Ros();

        ros.connect('ws://localhost:9090');

        pub = new ROSLIB.Topic({
          ros : ros,
          name : topic_name,
          //messageType : 'geometry_msgs/Twist'
          messageType : 'std_msgs/Float64'
        });


        }

// -------------------------------------------

  var msg = new ROSLIB.Message({
    data: 33.333
  });

    function change_slider() {
      var slider = document.getElementById("slider1");
      var out_frame = document.getElementById("output");

      out_frame.innerText = slider.value;
      
      msg.data = Number(slider.value);
      pub.publish(msg);
      console.log(topic_name);
    }
  </script>
</head>
<body>
  <input id="slider1" type="range" value="50" min="1" max="100" step=0.1 oninput="change_slider();"/>
  <div id="output"></div>
</body>
</html>

